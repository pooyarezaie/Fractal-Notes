<!DOCTYPE html>
<html lang="fa">
  <head>
    <meta charset="UTF-8">
    <title>{{ page.title | default: "یادداشت‌های فرکتالی" }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="{{ "/assets/css/style.css" | relative_url }}">
    <link rel="icon" type="image/png" href="{{ "/assets/img/logo.png" | relative_url }}">

    <!-- تنظیمات MathJax -->
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']]
        }
      };
    </script>
    <script id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
    </script>
  </head>

  <body>
    <header class="site-header">
      <div class="site-header-inner">
        <div class="site-brand">
          <a href="{{ "/" | relative_url }}" class="site-logo-link" aria-label="یادداشت‌های فرکتالی - صفحهٔ اصلی">
            <img src="{{ "/assets/img/logo.png" | relative_url }}" alt="یادداشت‌های فرکتالی" class="site-logo">
          </a>
          <div class="site-title-group">
            <a href="{{ "/" | relative_url }}" class="site-title">یادداشت‌های فرکتالی</a>
            <div class="site-subtitle">گام‌های کوچک در دل ساختارهای بزرگ ریاضی</div>
          </div>
        </div>
      </div>
    </header>

    <main class="container">
      {{ content }}
    </main>

    <footer class="site-footer">
      <div class="site-footer-inner">
        <span class="site-footer-label">شبکه‌های اجتماعی:</span>
        <a href="https://t.me/FractalNotes" class="social-link" target="_blank" rel="noopener">
          کانال تلگرام «Fractal Notes»
        </a>
      </div>
    </footer>

    <script>
      (function() {
        var activeOverlay = null;

        function closeOverlay() {
          if (!activeOverlay) return;
          activeOverlay.remove();
          activeOverlay = null;
        }

        function openOverlay(src, alt) {
          closeOverlay();

          var backdrop = document.createElement('div');
          backdrop.className = 'image-lightbox-backdrop';

          var img = document.createElement('img');
          img.className = 'image-lightbox-img';
          img.src = src;
          img.alt = alt || '';

          backdrop.appendChild(img);
          document.body.appendChild(backdrop);
          activeOverlay = backdrop;

          backdrop.addEventListener('click', function() {
            closeOverlay();
          });
        }

        document.addEventListener('click', function(event) {
          if (!event.target) return;
          var target = event.target;
          if (target.tagName === 'IMG' && target.closest('main')) {
            event.preventDefault();
            openOverlay(target.currentSrc || target.src, target.alt);
          }
        });

        document.addEventListener('keydown', function(event) {
          if (event.key === 'Escape' || event.key === 'Esc') {
            closeOverlay();
          }
        });
      })();
    </script>
  </body>
</html>
